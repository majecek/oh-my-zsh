#compdef prlctl
#autoload

_prlctl () {

  local cmd
  if (( CURRENT > 2)); then
    cmd=${words[2]}
    # Set the context for the subcommand.
    curcontext="${curcontext%:*:*}:prlctl-$cmd"
    # Narrow the range of words we are looking at to exclude `pass'
    (( CURRENT-- ))
    shift words
    # Run the completion for the subcommand
    case "${cmd}" in
      list)
        _arguments : \
          "-i[<ID | NAME>]" \
          "--info[<ID | NAME>]" \
        ;;
      snapshot-list)
        local -a uiid_lists
        uiid_lists=(${${${(f)"$(_call_program uiis  prlctl list --all | sed '1d' | sed 's/{\(.*\)}\(.*-\)\(.*\)/\1:\3/g')"}}})
		    _describe -t commands 'prlctl snapshot-list' uiid_lists

        ;;
    esac
  else  
    local -a commands
    commands=(
      "help:Help"
      "list:Lists the virtual machines currently existing on the Parallels server"
      "snapshot-list:This command is used to list Vm tree"
    )
    _describe -t commands 'prlctl' commands
    _arguments : \
      "--version[Output version information]" \
      "--help[Output help message]"
  fi      
}

compdef _prlctl prlctl